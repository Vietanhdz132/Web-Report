<div class="report-pvt">
  <h1 class="report-pvt__title">ğŸ“„ BÃ¡o cÃ¡o tuáº§n - PhÃ²ng VÃ´ Tuyáº¿n</h1>

  <!-- NÃºt Táº¡o má»›i -->
  <div class="report-pvt__create-wrapper">
    <a href="/report/pvt/create" class="report-pvt__button-create">â• Táº¡o bÃ¡o cÃ¡o má»›i</a>
  </div>

  <!-- Danh sÃ¡ch bÃ¡o cÃ¡o -->
  <section class="report-pvt__list">
  <h2 class="report-pvt__list-title">ğŸ“‹ Danh sÃ¡ch bÃ¡o cÃ¡o</h2>
<div class="report-pvt__table-wrapper">
  <table id="reportTable" class="report-pvt__table" style="display:none;">
    <thead>
      <tr>
        <th>TÃªn bÃ¡o cÃ¡o</th>
        <th>Sá»‘ hiá»‡u</th>
        <th>NgÃ y táº¡o</th>
        <th>PhÃ²ng</th>
        <th>HÃ nh Ä‘á»™ng</th>
      </tr>
    </thead>
    <tbody id="reportTableBody"></tbody>
  </table>
</div>
  <p id="noReports" class="report-pvt__no-data" style="display:none;">ChÆ°a cÃ³ bÃ¡o cÃ¡o nÃ o.</p>
</section>

</div>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
  const tbody = document.getElementById('reportTableBody');
  const noDataMsg = document.getElementById('noReports');
  const reportTable = document.getElementById('reportTable');

  if (!tbody || !noDataMsg || !reportTable) {
    console.error('âŒ Thiáº¿u pháº§n tá»­ trong DOM, kiá»ƒm tra láº¡i HTML!');
    return;
  }

  try {
    const res = await fetch('/report/pvt');
    const { success, reports } = await res.json();

    if (!success || !reports.length) {
      noDataMsg.style.display = 'block';
      reportTable.style.display = 'none';
      return;
    }

    noDataMsg.style.display = 'none';
    reportTable.style.display = 'table';

    // XÃ³a háº¿t cÃ¡c dÃ²ng cÅ© (náº¿u cÃ³)
    tbody.innerHTML = '';

    reports.forEach(report => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${report.reportName}</td>
        <td>${report.number}</td>
        <td>${report.date}</td>
        <td>${report.department || 'PhÃ²ng VÃ´ Tuyáº¿n'}</td>
        <td class="report-pvt__actions">
          <a href="/report/view/${report._id}" class="report-pvt__action-link">ğŸ“„ Xem</a>
          <a href="/report/edit/${report._id}" class="report-pvt__action-link">âœï¸ Sá»­a</a>
          <form action="/report/${report._id}" method="POST" class="report-pvt__action-form" style="display:inline;">
            <input type="hidden" name="_method" value="DELETE">
            <button type="submit" onclick="return confirm('XoÃ¡ bÃ¡o cÃ¡o nÃ y?')" class="report-pvt__action-delete">ğŸ—‘ï¸ XÃ³a</button>
          </form>
        </td>
      `;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error('âŒ Error loading reports:', err);
    alert('KhÃ´ng thá»ƒ táº£i danh sÃ¡ch bÃ¡o cÃ¡o.');
  }
});

</script>
