<div class="profile-container">
  <div class="profile-header">
  <h2>TH√îNG TIN CHUNG</h2>
  <div>
    <a href="#" id="editBtn" class="edit-link"><i class="fa fa-pen"></i> Ch·ªânh s·ª≠a</a>
  </div>
</div>


  <form id="profileForm" class="profile-form">
    <div class="form-grid">
      <div class="form-group">
        <label>H·ªç v√† t√™n</label>
        <input type="text" name="name" value="{{user.name}}" readonly />
      </div>
      <div class="form-group">
        <label>Username <span class="required">*</span></label>
        <input type="text" name="username" value="{{user.username}}" readonly />
      </div>

      <div class="form-group">
        <label>T√™n r√∫t g·ªçn</label>
        <input type="text" name="shortName" value="{{user.shortName}}" readonly />
      </div>
      <div class="form-group">
        <label>Email <span class="required">*</span></label>
        <input type="email" name="email" value="{{user.email}}" readonly />
      </div>

      <div class="form-group">
        <label>S·ªë ƒëi·ªán tho·∫°i</label>
        <input type="text" name="phone" value="{{user.phone}}" readonly />
      </div>
      <div class="form-group">
        <label>Ng√†y sinh</label>
        <input type="date" name="birthDay" value="{{user.birthDay}}" readonly />
      </div>

      <div class="form-group">
        <label>Ch·ª©c danh <span class="required">*</span></label>
        <input type="text" name="position" value="{{user.position}}" readonly />
      </div>
      <div class="form-group">
        <label>ƒê∆°n v·ªã <span class="required">*</span></label>
        <input type="text" name="department" value="{{user.department}}" readonly />
      </div>

      <div class="form-group">
        <label>Role</label>
        <input type="text" name="role" value="{{user.role}}" readonly />
      </div>

      <div class="form-actions" style="display: none;">
        <button type="submit" class="btn btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
        <button type="button" class="btn btn-secondary" id="cancelEditBtn">‚úñÔ∏è H·ªßy</button>
      </div>

    </div>
  

   
  </form>
</div>





<script>
 

  document.getElementById('editBtn').addEventListener('click', function (e) {
    e.preventDefault();
    document.querySelectorAll('#profileForm input').forEach(input => {
      if (input.name !== 'username' && input.name !== 'role') {
        input.removeAttribute('readonly');
      }
    });
    document.querySelector('.form-actions').style.display = 'flex';
  });


  document.getElementById('cancelEditBtn').addEventListener('click', function () {
    window.location.reload();
  });


  document.getElementById('profileForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const formData = new FormData(this);
    const data = {};
    formData.forEach((value, key) => {
      data[key] = value;
    });

    try {
      const res = await fetch('/auth/profile', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
          // N·∫øu d√πng JWT: th√™m Authorization
          // 'Authorization': 'Bearer ' + token
        },
        body: JSON.stringify(data),
      });

      const result = await res.json();
      if (result.success) {
        showAlert('C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng','success');
        setTimeout(() => {
          window.location.reload();
        }, 1500);

      } else {
        showAlert(result.message || 'C·∫≠p nh·∫≠t th·∫•t b·∫°i','danger');
      }
    } catch (err) {
      console.error('L·ªói c·∫≠p nh·∫≠t:', err);
      showAlert('L·ªói khi g·ª≠i y√™u c·∫ßu',error);
    }
  });


  

</script>
